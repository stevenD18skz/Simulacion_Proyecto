
import numpy as np
from scipy.sparse import lil_matrix, csr_matrix
from scipy.sparse.linalg import spsolve
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

import matplotlib.pyplot as plt
import numpy as np

def comparar_convergencia(error_jacobi, error_gauss, error_richardson,
                          iter_jacobi=None, iter_gauss=None, iter_richardson=None,
                          Residuo_jacobi=None, Residuo_gauss=None, Residuo_richardson=None,
                          Tiempo_jacobi=None, Tiempo_gauss=None, Tiempo_richardson=None):
    """
    Grafica y compara las convergencias de Jacobi, Gauss-Seidel y Richardson
    con anotaciones en recuadros que muestran métricas clave.
    
    Parámetros opcionales de métricas:
      - iter_*: número de iteraciones hasta converger
      - tiempo_*: tiempo total de ejecución
    """
    fig, ax = plt.subplots(figsize=(10, 6))
    
    # Plot de las tres curvas
    ax.semilogy(error_jacobi,     linestyle='-', marker='o', markersize=4, label='Jacobi')
    ax.semilogy(error_gauss,      linestyle='-', marker='o', markersize=4, label='Gauss-Seidel')
    ax.semilogy(error_richardson, linestyle='-', marker='o', markersize=2, label='Richardson')
    
    ax.set_xlabel('Iteración', fontsize=12)
    ax.set_ylabel('Error máximo (log)', fontsize=12)
    ax.set_title('Convergencia: Jacobi vs Gauss-Seidel vs Richardson', fontsize=14)
    ax.grid(True, which='both', linestyle='--', alpha=0.7)
    ax.legend()
    
    # Anotaciones al final de cada curva
    n_j, n_g, n_r = len(error_jacobi), len(error_gauss), len(error_richardson)
    ax.annotate(f"{error_jacobi[-1]:.2e}",
                xy=(n_j-1, error_jacobi[-1]),
                xytext=(5, 0), textcoords='offset points',
                va='center', fontsize=10,
                bbox=dict(boxstyle='round,pad=0.3', fc='white', alpha=0.8))
    ax.annotate(f"{error_gauss[-1]:.2e}",
                xy=(n_g-1, error_gauss[-1]),
                xytext=(5, 0), textcoords='offset points',
                va='center', fontsize=10,
                bbox=dict(boxstyle='round,pad=0.3', fc='white', alpha=0.8))
    ax.annotate(f"{error_richardson[-1]:.2e}",
                xy=(n_r-1, error_richardson[-1]),
                xytext=(5, 0), textcoords='offset points',
                va='center', fontsize=10,
                bbox=dict(boxstyle='round,pad=0.3', fc='white', alpha=0.8))

    # Recuadro comparativo con métricas
    if any(x is not None for x in 
           [iter_jacobi, iter_gauss, iter_richardson,
            Residuo_jacobi, Residuo_gauss, Residuo_richardson]):
        text = ""
        text += "Metricas de convergencia:\n"
        if iter_jacobi is not None:
            text += f"Jacobi: {iter_jacobi} iters"
            if Tiempo_jacobi is not None:
                text += f", {Tiempo_jacobi:.2f} s"

            if Residuo_jacobi is not None:
                text += f"\nResiduo: {Residuo_jacobi}"

            text += "\n"
        if iter_gauss is not None:
            text += f"Gauss-Seidel: {iter_gauss} iters"
            if Tiempo_jacobi is not None:
                text += f", {Tiempo_gauss:.2f} s"
            if Residuo_gauss is not None:
                text += f"\nResiduo: {Residuo_gauss}"
            text += "\n"
        if iter_richardson is not None:
            text += f"Richardson: {iter_richardson} iters"
            if Tiempo_jacobi is not None:
                text += f", {Tiempo_richardson:.2f} s"
            if Residuo_richardson is not None:
                text += f"\nResiduo: {Residuo_richardson}"
            text += "\n"
        
        # Insertar cuadro en la esquina superior izquierda
        ax.text(0.02, 0.98, text, transform=ax.transAxes,
                fontsize=10, va='top', ha='left',
                bbox=dict(boxstyle='round,pad=0.5', fc='white', alpha=0.9))
    
    plt.tight_layout()
    plt.show()



error_jacobi = [np.float64(0.25), np.float64(0.15625), np.float64(0.110107421875), np.float64(0.0815853551030159), np.float64(0.06981100298663867), np.float64(0.06420845082927534), np.float64(0.05767892697132465), np.float64(0.05162674293137837), np.float64(0.04539740443840479), np.float64(0.04021032079482434), np.float64(0.036651415904005336), np.float64(0.03426481989163116), np.float64(0.03224002962568745), np.float64(0.02979573225597215), np.float64(0.0276423348828016), np.float64(0.025660184128441732), np.float64(0.023603885409277325), np.float64(0.02180790918799469), np.float64(0.02056614264976281), np.float64(0.019493473975096987), np.float64(0.0185598112362671), np.float64(0.017470499420631502), np.float64(0.016527318792681267), np.float64(0.015480742596927222), np.float64(0.014575280253904921), np.float64(0.013605014004651028), np.float64(0.012764551898277354), np.float64(0.011989184310702117), np.float64(0.011397127479873925), np.float64(0.010890439287155051), np.float64(0.010316474782578133), np.float64(0.009820861358394495), np.float64(0.009278351852016087), np.float64(0.00880659097602815), np.float64(0.00830326469913445), np.float64(0.007863032464956843), np.float64(0.007402522484346974), np.float64(0.0069977399172895804), np.float64(0.006580825691558434), np.float64(0.00624497148702885), np.float64(0.005973281176718859), np.float64(0.00567911626530998), np.float64(0.005421125200406551), np.float64(0.005147087433048536), np.float64(0.004905236284432346), np.float64(0.004652254870275596), np.float64(0.004427808633063579), np.float64(0.004195946971232489), np.float64(0.003989306690562022), np.float64(0.0037780232722557927), np.float64(0.0035889768595355753), np.float64(0.0033973285879437265), np.float64(0.003225246989451147), np.float64(0.0030520434997952095), np.float64(0.002906393970361437), np.float64(0.002779216488983105), np.float64(0.0026474135646369634), np.float64(0.0025293359045009123), np.float64(0.0024080297423667296), np.float64(0.002298939848346948), np.float64(0.0021876992855877353), np.float64(0.0020873223540347763), np.float64(0.001985618699574615), np.float64(0.0018935690491758417), np.float64(0.0018008158295575727), np.float64(0.0017166371163420124), np.float64(0.00163222008653241), np.float64(0.0015554159189237193), np.float64(0.0014787152096382705), np.float64(0.0014087720033482132), np.float64(0.001339178026445842), np.float64(0.001275581687206706), np.float64(0.0012125061650777869), np.float64(0.0011547539336208001), np.float64(0.0011027048151427132), np.float64(0.0010522158379932256), np.float64(0.0010062164452926403), np.float64(0.000959950548037769), np.float64(0.0009177058009090799), np.float64(0.0008753668367222911), np.float64(0.0008366293601120844), np.float64(0.000797928393043601), np.float64(0.0007624531463678308), np.float64(0.0007271119312523278), np.float64(0.0006946601195142454), np.float64(0.0006624134531193759), np.float64(0.0006327552830747984), np.float64(0.0006033524762823761), np.float64(0.0005762690068600862), np.float64(0.0005494746817528429), np.float64(0.0005247589723742507), np.float64(0.0005003533488936174), np.float64(0.0004778110705301597), np.float64(0.0004555898744151299), np.float64(0.0004350395156465514), np.float64(0.00041481361201328726), np.float64(0.00039608638533050744), np.float64(0.00037768121980588654), np.float64(0.00036062075121104376), np.float64(0.00034387566227367383), np.float64(0.0003283375291683044), np.float64(0.00031339433705993014), np.float64(0.000299450518316452), np.float64(0.00028656755739811524), np.float64(0.00027380578749924833), np.float64(0.0002620012184898213), np.float64(0.0002503256641018803), np.float64(0.00023951395796148467), np.float64(0.00022883560540201686), np.float64(0.00021893702178968355), np.float64(0.0002091733913714977), np.float64(0.0002001137946322229), np.float64(0.0001911886207378588), np.float64(0.00018289925214995395), np.float64(0.00017474214289789347), np.float64(0.00016715936379901875), np.float64(0.00015970545104190825), np.float64(0.0001527704682935116), np.float64(0.00014596005615355456), np.float64(0.00013961863883160675), np.float64(0.0001333968569380839), np.float64(0.00012759905105608205), np.float64(0.00012191551701307146), np.float64(0.00011661536340601408), np.float64(0.00011142385771878427), np.float64(0.00010657911687367294), np.float64(0.0001018372725340444), np.float64(9.74091590828785e-05), np.float64(9.30781672082992e-05), np.float64(8.903109595606584e-05), np.float64(8.507542825542114e-05), np.float64(8.137677294969836e-05), np.float64(7.776392130826038e-05), np.float64(7.438378684418434e-05), np.float64(7.108401996097635e-05), np.float64(6.799502831722481e-05), np.float64(6.498116505818108e-05), np.float64(6.215825496000416e-05), np.float64(5.940545389856999e-05), np.float64(5.6825693979134506e-05), np.float64(5.431125846006024e-05), np.float64(5.1953673527144195e-05), np.float64(4.968927259092759e-05), np.float64(4.753597469010773e-05), np.float64(4.552409209555852e-05), np.float64(4.355172293049603e-05), np.float64(4.170784909876546e-05), np.float64(3.990129536486642e-05), np.float64(3.8211518824618484e-05), np.float64(3.655690625622987e-05), np.float64(3.5008440815054165e-05), np.float64(3.3493037318269026e-05), np.float64(3.207413612073273e-05), np.float64(3.068626159608012e-05), np.float64(2.9386136814496533e-05), np.float64(2.8115079375362617e-05), np.float64(2.692382733991694e-05), np.float64(2.57597656081604e-05), np.float64(2.466829715185026e-05), np.float64(2.3602228302305184e-05), np.float64(2.2602204074226306e-05), np.float64(2.1625877292916207e-05), np.float64(2.0709647782016227e-05), np.float64(1.9815502806122542e-05), np.float64(1.8976052810704136e-05), np.float64(1.8157163223120332e-05), np.float64(1.738806050073649e-05), np.float64(1.663808146160073e-05), np.float64(1.5933429298939372e-05), np.float64(1.524654940782133e-05), np.float64(1.4600942853548737e-05), np.float64(1.3971839850190904e-05), np.float64(1.3380325364506507e-05), np.float64(1.2804125389176413e-05), np.float64(1.2262163672518978e-05), np.float64(1.1734403823099315e-05), np.float64(1.123783559812963e-05), np.float64(1.0754429535422827e-05), np.float64(1.02994440673021e-05), np.float64(9.856650435707826e-06), np.float64(9.439756588333625e-06), np.float64(9.034150034240018e-06), np.float64(8.652149671273257e-06), np.float64(8.280594255435925e-06), np.float64(7.930557807594996e-06), np.float64(7.590182622002617e-06), np.float64(7.2694266533279706e-06), np.float64(6.957603467000473e-06), np.float64(6.663670083867368e-06), np.float64(6.377992853745518e-06), np.float64(6.1086308116437005e-06), np.float64(5.846896908009991e-06), np.float64(5.600044280934524e-06), np.float64(5.360237287033165e-06), np.float64(5.134005574738976e-06), np.float64(4.914279531836874e-06), np.float64(4.706939088619522e-06), np.float64(4.505604067381319e-06), np.float64(4.315570745511144e-06), np.float64(4.131079633956647e-06), np.float64(3.956902542470719e-06), np.float64(3.7878389494566678e-06), np.float64(3.628189237381285e-06), np.float64(3.473256418265458e-06), np.float64(3.3269169977395707e-06), np.float64(3.1863090066142075e-06), np.float64(3.051496764605588e-06), np.float64(2.924501693243875e-06), np.float64(2.8008079165087185e-06), np.float64(2.6842566686752223e-06), np.float64(2.5707626395421457e-06), np.float64(2.4637953817963076e-06), np.float64(2.3596583245688585e-06), np.float64(2.2614859610387006e-06), np.float64(2.1659327807815876e-06), np.float64(2.075831158243613e-06), np.float64(1.9881526912984837e-06), np.float64(1.9054572738264053e-06), np.float64(1.8250030096311765e-06), np.float64(1.7491039855377366e-06), np.float64(1.6752772212663691e-06), np.float64(1.6056150083654241e-06), np.float64(1.537868401707554e-06), np.float64(1.4739295188387347e-06), np.float64(1.4117610065145225e-06), np.float64(1.3530742820760944e-06), np.float64(1.296023334401708e-06), np.float64(1.2421564248715766e-06), np.float64(1.1898006092303515e-06), np.float64(1.1403568023898858e-06), np.float64(1.092308630129546e-06), np.float64(1.0469239105914685e-06), np.float64(1.002827944143747e-06), np.float64(9.61168299312698e-07)]
error_gauss = [np.float64(0.3124992), np.float64(0.19174976238399988), np.float64(0.12532302781964744), np.float64(0.09634393616144704), np.float64(0.08185419958519796), np.float64(0.06855154031535071), np.float64(0.05727329753019278), np.float64(0.050863437440906434), np.float64(0.04524959797745143), np.float64(0.039753273804407185), np.float64(0.03448022617159119), np.float64(0.031199685581587755), np.float64(0.028043989833059835), np.float64(0.024977929168450652), np.float64(0.022094047782896697), np.float64(0.019443714802065082), np.float64(0.01756147091346849), np.float64(0.015842605989035308), np.float64(0.014230804332250213), np.float64(0.012740412565949655), np.float64(0.011377114211444883), np.float64(0.010140495947800698), np.float64(0.009103727041224363), np.float64(0.008251619805994537), np.float64(0.007464670791492156), np.float64(0.00674230295377809), np.float64(0.006082467870147212), np.float64(0.005482139812507503), np.float64(0.004937694006970028), np.float64(0.0044451891527456655), np.float64(0.004000572976754491), np.float64(0.0036235911141397625), np.float64(0.003294417870282007), np.float64(0.002993364983531921), np.float64(0.002718548556068734), np.float64(0.0024680739323311718), np.float64(0.002240079373630466), np.float64(0.002032766693026933), np.float64(0.0018444217631182758), np.float64(0.0016734272732916722), np.float64(0.0015182696477572533), np.float64(0.0013775416420393483), np.float64(0.00124994180899618), np.float64(0.0011342717587120577), np.float64(0.0010316328619393023), np.float64(0.000941193975247806), np.float64(0.0008586024570652051), np.float64(0.0007832080908201922), np.float64(0.0007144068998708175), np.float64(0.0006516396300223215), np.float64(0.0005943898231760836), np.float64(0.0005421816267257851), np.float64(0.0004945774499466871), np.float64(0.0004511755518583904), np.float64(0.000411607623729382), np.float64(0.0003755364125258287), np.float64(0.000342653418364397), np.float64(0.0003126766887034671), np.float64(0.0002853487240286612), np.float64(0.00026043450368629095), np.float64(0.00023771963589808154), np.float64(0.00021700863255710856), np.float64(0.00019812330688423474), np.float64(0.0001809012902375673), np.float64(0.00016519466313089093), np.float64(0.00015086869471953035), np.float64(0.00013780068453844718), np.float64(0.00012607748324375279), np.float64(0.0001154122206226682), np.float64(0.00010565362210016027), np.float64(9.672453383252622e-05), np.float64(8.855431458337781e-05), np.float64(8.107830161957486e-05), np.float64(7.423731700564873e-05), np.float64(6.797721193327333e-05), np.float64(6.224844671470775e-05), np.float64(5.7005704099194476e-05), np.float64(5.220753363030517e-05), np.float64(4.7816024845798166e-05), np.float64(4.3796507215615454e-05), np.float64(4.0117274820394844e-05), np.float64(3.674933388256307e-05), np.float64(3.366617137615102e-05), np.float64(3.084354305202264e-05), np.float64(2.8259279330311582e-05), np.float64(2.5893107613139676e-05), np.float64(2.372648968138047e-05), np.float64(2.174247293171283e-05), np.float64(1.9925554308047877e-05), np.float64(1.826155586787115e-05), np.float64(1.673751100675358e-05), np.float64(1.5341560443471458e-05), np.float64(1.4062857137675522e-05), np.float64(1.2891479383408955e-05), np.float64(1.1818351377895775e-05), np.float64(1.0835170630496549e-05), np.float64(9.9343416225528e-06), np.float64(9.108915183297928e-06), np.float64(8.352533089173164e-06), np.float64(7.65937743743561e-06), np.float64(7.024124381749264e-06), np.float64(6.441901854031817e-06), np.float64(5.9082509273333805e-06), np.float64(5.419090506275648e-06), np.float64(4.970685056004953e-06), np.float64(4.55961510836822e-06), np.float64(4.182750304088101e-06), np.float64(3.837224751834789e-06), np.float64(3.5204145044653856e-06), np.float64(3.2299169681337947e-06), np.float64(2.963532078736897e-06), np.float64(2.7192450917923328e-06), np.float64(2.495210846747975e-06), np.float64(2.289739378741329e-06), np.float64(2.1012827611244234e-06), np.float64(1.9285384078304713e-06), np.float64(1.770981818610684e-06), np.float64(1.626348226091423e-06), np.float64(1.4935731738885405e-06), np.float64(1.3716802695212804e-06), np.float64(1.2597738673764125e-06), np.float64(1.157032362003596e-06), np.float64(1.0627020405745702e-06), np.float64(9.760914476686366e-07)]
error_richardson = [np.float64(0.125), np.float64(0.1015625), np.float64(0.08425140380859375), np.float64(0.07097284080009558), np.float64(0.060489075298868884), np.float64(0.05202490766859597), np.float64(0.04507335281476179), np.float64(0.0392885422703858), np.float64(0.03442519197658436), np.float64(0.0327266423230493), np.float64(0.0315824992445776), np.float64(0.030305053387156777), np.float64(0.028947331066255143), np.float64(0.02754924659066192), np.float64(0.026140889235744705), np.float64(0.024744798392923078), np.float64(0.023377622719205324), np.float64(0.022051381367301687), np.float64(0.020774450990787903), np.float64(0.019552351961562457), np.float64(0.018388380257107137), np.float64(0.017515821488776808), np.float64(0.017060258476359336), np.float64(0.016577858424182024), np.float64(0.01607597289653417), np.float64(0.015560932282333318), np.float64(0.015038151825778183), np.float64(0.014512231167201725), np.float64(0.013987046846073594), np.float64(0.013500713329755231), np.float64(0.01302010981312439), np.float64(0.012544864417955302), np.float64(0.012076812484211902), np.float64(0.01161746976658342), np.float64(0.01116807020270432), np.float64(0.010729600175093106), np.float64(0.01030282949584991), np.float64(0.009995149631421202), np.float64(0.009769228630929187), np.float64(0.009538475439822785), np.float64(0.009304170051250001), np.float64(0.009067472602631738), np.float64(0.008829430029653819), np.float64(0.008590982799546246), np.float64(0.008352971644072234), np.float64(0.008116144224340234), np.float64(0.007881161670382632), np.float64(0.007648604948405993), np.float64(0.0074189810176831135), np.float64(0.0071927287472453175), np.float64(0.006970224569840853), np.float64(0.006751787857090728), np.float64(0.006537686005427123), np.float64(0.006328139227282994), np.float64(0.006123325046174219), np.float64(0.0059233824978213835), np.float64(0.005753321622131665), np.float64(0.005623842334869947), np.float64(0.005494420096445937), np.float64(0.005365345330205034), np.float64(0.005236881961453556), np.float64(0.00510926883977655), np.float64(0.004982721153966718), np.float64(0.004857431829802708), np.float64(0.00473357290235713), np.float64(0.004611296855844933), np.float64(0.0044907379252391395), np.float64(0.0043720133549877615), np.float64(0.004255224611164409), np.float64(0.004140458544279806), np.float64(0.004027788500777584), np.float64(0.00391727538193973), np.float64(0.0038089686495404477), np.float64(0.0037029072781213784), np.float64(0.003599120654214481), np.float64(0.003497629423229647), np.float64(0.0033984462850445846), np.float64(0.0033015767396034883), np.float64(0.00320701978404544), np.float64(0.0031147685630528105), np.float64(0.0030372678357164944), np.float64(0.0029684116462594685), np.float64(0.0029004140022925945), np.float64(0.0028333217896757924), np.float64(0.0027671764079320047), np.float64(0.0027020141130787846), np.float64(0.0026378663483304005), np.float64(0.0025747600622395323), np.float64(0.0025127180139809632), np.float64(0.002451759065596887), np.float64(0.0023918984611300286), np.float64(0.002333148092660815), np.float64(0.0022755167533448067), np.float64(0.0022190103776170717), np.float64(0.0021636322687854583), np.float64(0.002109383314287663), np.float64(0.002056262188925965), np.float64(0.0020042655464264656), np.float64(0.0019533881996984972), np.float64(0.0019036232901880183), np.float64(0.0018549624467353578), np.float64(0.0018073959343578455), np.float64(0.001760912793383411), np.float64(0.0017155009693639923), np.float64(0.0016711474341976535), np.float64(0.001627838298883477), np.float64(0.0015855589183286284), np.float64(0.0015442939886185867), np.float64(0.0015040276371533455), np.float64(0.0014647435060398486), np.float64(0.0014277814894281832), np.float64(0.001395645957552783), np.float64(0.0013640908293619405), np.float64(0.001333115748087634), np.float64(0.0013027195366416427), np.float64(0.0012729002608991517), np.float64(0.001243655289688967), np.float64(0.001214981351592348), np.float64(0.0011868745886552032), np.float64(0.0011593306071215484), np.float64(0.001132344525297037), np.float64(0.0011059110186526647), np.float64(0.0010800243622787584), np.float64(0.0010546784707986432), np.float64(0.0010298669358508213), np.float64(0.0010055830612471321), np.float64(0.000981819895911713), np.float64(0.0009585702647050352), np.float64(0.0009358267972337079), np.float64(0.0009135819547442842), np.float64(0.0008918280551971692), np.float64(0.0008705572966135581), np.float64(0.0008497617787846805), np.float64(0.000829433523430884), np.float64(0.0008095644928933707), np.float64(0.0007901466074398099), np.float64(0.0007711717612606105), np.float64(0.0007526318372303517), np.float64(0.0007345187205048938), np.float64(0.0007168243110227898), np.float64(0.000699540534975458), np.float64(0.0006826593553078638), np.float64(0.0006661727813094696), np.float64(0.0006500728773504673), np.float64(0.0006343517708180012), np.float64(0.0006190016593020519), np.float64(0.0006040148170799635), np.float64(0.0005893836009444073), np.float64(0.0005751004554191174), np.float64(0.0005611579174023456), np.float64(0.0005475486202773964), np.float64(0.0005351315864986703), np.float64(0.0005232196674689235), np.float64(0.0005115542401255358), np.float64(0.000500131412778172), np.float64(0.0004889472792095623), np.float64(0.00047799792459905316), np.float64(0.0004672794310362709), np.float64(0.0004567878826456852), np.float64(0.0004465193703425928), np.float64(0.00043646999623954505), np.float64(0.00042663587772185697), np.float64(0.0004170131512103281), np.float64(0.00040759797562768465), np.float64(0.0003983865355853818), np.float64(0.0003893750443065794), np.float64(0.00038055974629960066), np.float64(0.0003719369197967985), np.float64(0.00036350287897178883), np.float64(0.00035525397594858934), np.float64(0.00034718660261439375), np.float64(0.0003392971922484061), np.float64(0.00033158222097727275), np.float64(0.0003240382090680897), np.float64(0.0003166617220691462), np.float64(0.0003094493718077896), np.float64(0.00030239781725459265), np.float64(0.0002955037652625249), np.float64(0.00028876397118925455), np.float64(0.00028217523941041626), np.float64(0.00027573442373101265), np.float64(0.00026943842770230054), np.float64(0.00026328420485021526), np.float64(0.0002572687588219768), np.float64(0.0002513891434566814), np.float64(0.00024564246278518584), np.float64(0.00024002587096478585), np.float64(0.000234536572153832), np.float64(0.00022917182033027), np.float64(0.0002239289190590516), np.float64(0.00021880522121277792), np.float64(0.00021379812864858496), np.float64(0.00020890509184586686), np.float64(0.00020412360950768872), np.float64(0.0001994512281295554), np.float64(0.00019488554153820564), np.float64(0.000190424190403509), np.float64(0.0001860648617260711), np.float64(0.00018180528830319403), np.float64(0.00017764324817526406), np.float64(0.00017357656405513658), np.float64(0.0001696031027422), np.float64(0.00016572077452340633), np.float64(0.00016192753256274786), np.float64(0.0001582213722810537), np.float64(0.00015460033072771376), np.float64(0.00015106248594549287), np.float64(0.00014762041503840788), np.float64(0.00014439520979821733), np.float64(0.00014123910871047515), np.float64(0.00013815071908858666), np.float64(0.00013512867141484704), np.float64(0.00013217161922731064), np.float64(0.00012927823898905853), np.float64(0.0001264472299418487), np.float64(0.00012367731394495143), np.float64(0.00012096723530043506), np.float64(0.00011831576056613059), np.float64(0.00011572167835727911), np.float64(0.00011318379913764453), np.float64(0.00011070095500135486), np.float64(0.00010827199944615714), np.float64(0.0001058958071389365), np.float64(0.00010357127367429925), np.float64(0.00010129731532697843), np.float64(9.907286879872894e-05), np.float64(9.689689096048904e-05), np.float64(9.47683585900439e-05), np.float64(9.26862681063645e-05), np.float64(9.064963530063516e-05), np.float64(8.865749506469487e-05), np.float64(8.670890111748354e-05), np.float64(8.480292572974067e-05), np.float64(8.293865944733312e-05), np.float64(8.111521081389927e-05), np.float64(7.933170609300858e-05), np.float64(7.758728898989738e-05), np.float64(7.588112037371624e-05), np.float64(7.42123779999858e-05), np.float64(7.258025623385893e-05), np.float64(7.098396577434722e-05), np.float64(6.942273337989501e-05), np.float64(6.789580159517995e-05), np.float64(6.640242847971844e-05), np.float64(6.494188733820124e-05), np.float64(6.351346645290183e-05), np.float64(6.211646881822816e-05), np.float64(6.075021187744575e-05), np.float64(5.9414027262183976e-05), np.float64(5.810726053392265e-05), np.float64(5.682927092874142e-05), np.float64(5.557943110437989e-05), np.float64(5.435712689039722e-05), np.float64(5.316175704113422e-05), np.float64(5.1992732991740885e-05), np.float64(5.084947861719128e-05), np.float64(4.9731429994467525e-05), np.float64(4.863803516783348e-05), np.float64(4.75687539173758e-05), np.float64(4.652305753076848e-05), np.float64(4.550042857824544e-05), np.float64(4.450036069087692e-05), np.float64(4.352235834215095e-05), np.float64(4.256593663286618e-05), np.float64(4.163062107938163e-05), np.float64(4.0715947405051795e-05), np.float64(3.9821461335137366e-05), np.float64(3.894671839493885e-05), np.float64(3.809128371129682e-05), np.float64(3.725473181734935e-05), np.float64(3.643664646050653e-05), np.float64(3.563662041393768e-05), np.float64(3.4854255290938903e-05), np.float64(3.408916136284502e-05), np.float64(3.3340957380013404e-05), np.float64(3.2609270395930634e-05), np.float64(3.1893735594645486e-05), np.float64(3.119399612108076e-05), np.float64(3.0509702914675862e-05), np.float64(2.9840514545914894e-05), np.float64(2.918609705601244e-05), np.float64(2.854612379948479e-05), np.float64(2.7920275289690448e-05), np.float64(2.7308239047403986e-05), np.float64(2.6709709452181496e-05), np.float64(2.6124387596518123e-05), np.float64(2.555198114299839e-05), np.float64(2.4992204184083087e-05), np.float64(2.4444777104531086e-05), np.float64(2.390942644691057e-05), np.float64(2.3385884779167636e-05), np.float64(2.2878744293189113e-05), np.float64(2.238899916397972e-05), np.float64(2.1909724726021162e-05), np.float64(2.1440699141035495e-05), np.float64(2.0981705148822953e-05), np.float64(2.053252997900938e-05), np.float64(2.0092965264124812e-05), np.float64(1.9662806954053548e-05), np.float64(1.9241855231940064e-05), np.float64(1.8829914431382224e-05), np.float64(1.8426792955155642e-05), np.float64(1.8032303195060292e-05), np.float64(1.764626145338478e-05), np.float64(1.726848786551069e-05), np.float64(1.6898806323913698e-05), np.float64(1.6537044403465823e-05), np.float64(1.618303328809219e-05), np.float64(1.583660769858495e-05), np.float64(1.5497605821907415e-05), np.float64(1.5165869241438209e-05), np.float64(1.4841242868827868e-05), np.float64(1.4523574876762062e-05), np.float64(1.4212716633155093e-05), np.float64(1.3908522636422844e-05), np.float64(1.3610850452019009e-05), np.float64(1.3319560650066702e-05), np.float64(1.3034516744214947e-05), np.float64(1.2755585131528254e-05), np.float64(1.248263503363022e-05), np.float64(1.2215538438865167e-05), np.float64(1.1954170045577243e-05), np.float64(1.1698407206389771e-05), np.float64(1.1448129873721474e-05), np.float64(1.1203220546125763e-05), np.float64(1.0963564215829876e-05), np.float64(1.0729048317146045e-05), np.float64(1.0499562676035704e-05), np.float64(1.027499946043493e-05), np.float64(1.0055253131816578e-05), np.float64(9.840220397394468e-06), np.float64(9.629800163552969e-06), np.float64(9.423893489945436e-06), np.float64(9.222403544679919e-06), np.float64(9.02523556027619e-06), np.float64(8.832296790485735e-06), np.float64(8.643496468125201e-06), np.float64(8.458745763538515e-06), np.float64(8.277957744019457e-06), np.float64(8.101047333975528e-06), np.float64(7.927931276024463e-06), np.float64(7.758528092647387e-06), np.float64(7.592758048791454e-06), np.float64(7.430543115216105e-06), np.float64(7.271806932471626e-06), np.float64(7.116474775710233e-06), np.float64(6.964473520173711e-06), np.float64(6.815731607360246e-06), np.float64(6.670179011962008e-06), np.float64(6.527747209362113e-06), np.float64(6.388369143886466e-06), np.float64(6.251979197650364e-06), np.float64(6.1185131601367165e-06), np.float64(5.987908198240241e-06), np.float64(5.860102827092755e-06), np.float64(5.735036881380503e-06), np.float64(5.612651487317469e-06), np.float64(5.4928890351345805e-06), np.float64(5.375693152239879e-06), np.float64(5.261008676816131e-06), np.float64(5.148781632027954e-06), np.float64(5.038959200814149e-06), np.float64(4.9314897011222336e-06), np.float64(4.826322561613356e-06), np.float64(4.723408298085082e-06), np.float64(4.622698490170994e-06), np.float64(4.5241457586253295e-06), np.float64(4.427703743041472e-06), np.float64(4.333327080134089e-06), np.float64(4.240971382317905e-06), np.float64(4.150593216891746e-06), np.float64(4.062150085577161e-06), np.float64(3.9756004044599294e-06), np.float64(3.890903484489505e-06), np.float64(3.808019512224818e-06), np.float64(3.726909531032308e-06), np.float64(3.6475354228550943e-06), np.float64(3.5698598900368666e-06), np.float64(3.493846437874566e-06), np.float64(3.419459357252969e-06), np.float64(3.346663707909729e-06), np.float64(3.2754253017581176e-06), np.float64(3.2057106868873514e-06), np.float64(3.137487131663282e-06), np.float64(3.0707226092267578e-06), np.float64(3.005385782401903e-06), np.float64(2.941445988824496e-06), np.float64(2.878873226441265e-06), np.float64(2.817638139270325e-06), np.float64(2.757712003618242e-06), np.float64(2.6990667142791434e-06), np.float64(2.6416747713905954e-06), np.float64(2.5855092673406156e-06), np.float64(2.5305438739953103e-06), np.float64(2.4767528302451728e-06), np.float64(2.4241109297704175e-06), np.float64(2.3725935091315205e-06), np.float64(2.3221764360352383e-06), np.float64(2.272836097893307e-06), np.float64(2.224549390627959e-06), np.float64(2.1772937077114887e-06), np.float64(2.1310469294590816e-06), np.float64(2.0857874125143193e-06), np.float64(2.041493979574628e-06), np.float64(1.998145909344411e-06), np.float64(1.955722926710903e-06), np.float64(1.914205193143444e-06), np.float64(1.8735732972222227e-06), np.float64(1.833808245460178e-06), np.float64(1.7948914533077954e-06), np.float64(1.756804736274039e-06), np.float64(1.7195303013726334e-06), np.float64(1.6830507385954242e-06), np.float64(1.6473490126728946e-06), np.float64(1.6124084550806687e-06), np.float64(1.5782127559374107e-06), np.float64(1.5447459564950375e-06), np.float64(1.5119924413492004e-06), np.float64(1.4799369311719801e-06), np.float64(1.4485644753922135e-06), np.float64(1.4181160174290747e-06), np.float64(1.3883647174562763e-06), np.float64(1.3592390546510186e-06), np.float64(1.330725854587816e-06), np.float64(1.3028122201063665e-06), np.float64(1.2754855254886396e-06), np.float64(1.2487334107185417e-06), np.float64(1.2225437759956633e-06), np.float64(1.196904776209622e-06), np.float64(1.1718048156539126e-06), np.float64(1.1472325427511898e-06), np.float64(1.1231768449821355e-06), np.float64(1.0996268438082826e-06), np.float64(1.0765718898070775e-06), np.float64(1.054001557846883e-06), np.float64(1.0319056423675472e-06), np.float64(1.010274152798491e-06), np.float64(9.890973090199051e-07)]



# Suponiendo que ya tienes tus listas de errores y métricas:
# error_jacobi, error_gauss, error_richardson
# gs_iters, jac_iters, ric_iters
# gs_time, jac_time, ric_time

comparar_convergencia(
    error_jacobi, error_gauss, error_richardson,
    iter_jacobi=len(error_jacobi),
    iter_gauss=len(error_gauss),
    iter_richardson=len(error_richardson),
    #Residuo_jacobi=1,
    Residuo_gauss=3.04e-06,
    Residuo_richardson=1.25e-05,   
    Tiempo_jacobi=0.25555,
    Tiempo_gauss=0.2167,
    Tiempo_richardson=0.3867,
)
